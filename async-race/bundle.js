(()=>{"use strict";const e=(e,t,n,a)=>{const r=document.createElement(e);if(a&&(r.innerText=a),t)if("string"==typeof t)r.classList.add(t);else{const e=t.filter((e=>void 0!==e));e.length>0&&r.classList.add(...e)}let i;return i=n?"string"==typeof n&&document.querySelector(n)?document.querySelector(n):n instanceof HTMLElement?n:document.querySelector("body"):document.querySelector("body"),i.append(r),r},t=(t,n)=>{const{label:a,type:r}=t,i=e("button","Button-module__root--cpeag",n,a);return i.type=r||"button",i},n={root:"ViewSettings-module__root--iDTg1",header:"ViewSettings-module__header--qrkfB",title:"ViewSettings-module__title--x6lHA",page:"ViewSettings-module__page--R2AfP"},a=()=>{const{winners:e,garage:t,viewSettings:n}=z;e.container.style.display="none",t.container.style.display="flex",n.garageTitle.style.display="block",n.winnersTitle.style.display="none",n.garagePage.style.display="block",n.winnersPage.style.display="none",n.garagePagination.style.display="block",n.winnersPagination.style.display="none"},r=()=>{const{winners:e,garage:t,viewSettings:n}=z;e.container.style.display="flex",t.container.style.display="none",n.garageTitle.style.display="none",n.winnersTitle.style.display="block",n.garagePage.style.display="none",n.winnersPage.style.display="block",n.garagePagination.style.display="none",n.winnersPagination.style.display="block"},i=()=>{z.view="garage",sessionStorage.setItem("view","garage"),a()},s=async()=>{z.view="winners",sessionStorage.setItem("view","winners"),r()},l=a=>{const r=e("div",n.root,a),i=e("p",n.title,r),s=e("p",n.title,r),l=e("div",n.header,r),o=t({label:"Garage"},l),d=t({label:"Winners"},l),g=e("p",n.page,r),c=e("p",n.page,r),u=e("div",n.pagination,r),C=t({label:"Prev"},u),p=t({label:"Next"},u),w=e("div",n.pagination,r);return{container:r,garageBtn:o,winnersBtn:d,garageTitle:i,winnersTitle:s,garagePage:g,winnersPage:c,winnersPagination:u,winnersPrev:C,winnersNext:p,garagePagination:w,garagePrev:t({label:"Prev"},w),garageNext:t({label:"Next"},w)}},o="http://localhost:3000",d=`${o}/garage`,g=`${o}/engine`,c=`${o}/winners`,u=e=>new Error(`Cannot ${e}, get: UNEXPECTED_RESPONSE_STATUS`),C=e=>new Error(`Cannot ${e}, get: NOT_FOUND`),p=e=>new Error(`Cannot ${e}, get: BAD_REQUEST`),w=e=>new Error(`Cannot ${e}, get: TOO_MANY_REQUESTS`),y=e=>new Error(`Cannot ${e}, get: INTERNAL_SERVER_ERROR`),m=async e=>{try{const t=await fetch(`${d}/${e}`);return 200===t.status?[await t.json(),null]:[null,u("Get Car")]}catch(e){return[null,e]}},h=async e=>{try{if(201===(await fetch(`${d}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).status)return;return u("Create Car")}catch(e){return e}},f=async(e,t)=>{try{const n=await fetch(`${g}?id=${e}&status=${t}`,{method:"PATCH"});if(200===n.status)return[await n.json(),null];const a="Set Car Engine";return 400===n.status?[null,p(a)]:404===n.status?[null,C(a)]:[null,u(a)]}catch(e){return[null,e]}},v=(e,t)=>{let n=parseInt(e.substring(1,3),16),a=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16);return n=parseInt(""+n*(100+t)/100),a=parseInt(""+a*(100+t)/100),r=parseInt(""+r*(100+t)/100),n=n<255?n:255,a=a<255?a:255,r=r<255?r:255,"#"+(1==n.toString(16).length?"0"+n.toString(16):n.toString(16))+(1==a.toString(16).length?"0"+a.toString(16):a.toString(16))+(1==r.toString(16).length?"0"+r.toString(16):r.toString(16))},S=e=>{const t=v(e,-75),n=v(e,50);return`\n  <svg version="1.2" baseProfile="tiny-ps" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1280 569" width="1280" height="569">\n      <path fill-rule="evenodd" style="fill: ${e}" d="M382.2 112.9L386.9 115.9L405.7 114.5C535.1 105 645.1 108.8 694.9 124.5C720.8 132.7 798.8 173.4 880.1 221.1L903.7 235L926.6 235C979.6 235.1 1079.7 245.3 1132 256.1C1185.5 267.1 1226.6 278.7 1248.8 289.1C1266.8 297.5 1272.5 303 1277.1 316.5C1279.3 323 1279.5 324.9 1279.4 342.5C1279.3 361.6 1278.4 372.3 1275.3 392.2C1273.7 402.4 1273.7 403.3 1275.5 411.2C1276.6 415.8 1277.4 423.1 1277.5 427.5C1277.5 434.5 1277.1 436.1 1274.7 440.2C1269.6 448.9 1262.3 452.6 1244.3 455.4C1235.1 456.8 1197.2 459.6 1196.5 458.8C1196.3 458.6 1196.9 455.3 1197.7 451.5C1199.7 442.6 1200 416.9 1198.2 408.5C1191.9 379 1176.1 355.5 1152.2 339.8C1112.6 314 1067.8 314.9 1027.9 342.2C999.7 361.4 984.8 386.1 982 418.1C980.9 431.7 983.2 455.5 986.5 464.2C987.2 465.9 972.5 466 687 466L386.8 466L387.6 457.8C389.2 442.4 388.5 416.5 386.3 405.9C379.5 374.1 358.1 347.6 326.5 331.7C277.7 307.3 214.1 326.7 186 374.6C176.4 391.1 172.1 407.5 171.4 430.5L170.9 446.5L167.7 446.3C155.9 445.6 69.4 437.4 59 435.9C40.2 433.3 25.2 425.7 23.5 417.8C22.6 413.8 17.6 408.4 10.3 403.5C7.1 401.4 4.4 399.5 4.2 399.4C3 398.8 0.9 380.4 1.4 375C2.4 365.3 2.4 364.9 1.1 359.1C-1.5 346.7 0.9 323 5.9 312.4C8.6 306.6 14 301 16.9 301C17.9 301 18 298.9 17.5 292.2C16 273 16.4 265.1 19.4 255.2C22.4 245.2 22.3 241.1 18.9 237.5C17.1 235.5 17.1 235.3 21.8 227.5L26.5 219.5L38 219.3C63.8 218.8 89.9 216.2 100 213C101.9 212.4 110.4 211.5 118.9 211C138.8 209.7 144.7 208.3 161 200.6C186.5 188.5 243.9 164.9 321.3 134.5C332.2 130.2 341.5 126 341.9 125.1C342.4 124.2 343.1 121 343.5 118C344.6 108.7 345.3 107.7 352.5 105.9C359.9 104 373 107.1 382.2 112.9ZM542.4 132.5L523 132.4C501 132.4 496.6 132.5 472 134C390.1 139.1 347.1 148.2 310.2 168C296.6 175.4 292.2 178.8 291 182.8C288.2 192.9 290.7 206.3 296.9 215.4C307.8 231.3 318.5 235.3 354.2 236.9C392.4 238.7 558.9 243.4 559.6 242.7C559.9 242.4 555.8 211.1 552.5 188.5C549.5 167.5 545 141.5 543.7 137L542.4 132.5ZM583 134L578.3 134L595.8 188L613.4 242L794.2 242L793.3 237.7C791.8 230.1 792.4 222.7 794.8 218.8C797.4 214.7 804 211 808.8 211C810.6 211 812 210.7 812 210.2C811.9 209 788.1 191.9 774 183.1C747.1 166.2 723 155.1 702 149.9C680.3 144.6 646.9 139.6 608.6 136C597.1 134.9 585.5 134 583 134Z" />\n      <path fill-rule="evenodd" style="fill: ${t}" d="M306.2 328.9C343.9 338.7 372.8 367.9 382.2 405.7C385.2 417.6 385.4 440.7 382.6 452.4C370.9 502.4 325.7 536.6 275 533.7C230 531.1 191.6 499.6 180.3 456C177.2 444.2 176.2 426.7 177.9 415C184.3 371.5 218.6 335.7 261.7 327.5C272.6 325.5 295.7 326.2 306.2 328.9ZM267.5 357.4C252.7 360.2 240.1 367 229 378C217.8 389.2 211.4 401.4 208.4 416.6C197.9 471.7 252.2 518 305.3 499.4C328.4 491.4 346.8 471.2 352.6 447.5C355 438 354.9 420.7 352.6 412C348.5 396.9 339.1 382.1 327.5 372.7C320.4 367 307.9 360.6 299.5 358.5C291 356.3 275.9 355.8 267.5 357.4Z" />\n      <path style="fill: ${n}" d="M291.8 383.2C292 392.2 292.5 399.9 293 400.4C294.7 402.1 303.8 394.6 313.1 383.8L318.2 378.1L313.4 375C308.2 371.7 300.3 368.5 294.9 367.5L291.5 366.9L291.8 383.2Z" />\n      <path style="fill: ${n}" d="M259.1 370C252.9 372.2 242.4 378.2 242.7 379.4C243 380.7 266.4 401 267.6 401C268.3 401 269.1 400.3 269.4 399.4C270.2 397.4 270.2 386.7 269.3 376.2C268.6 366.7 268.5 366.6 259.1 370Z" />\n      <path style="fill: ${n}" d="M320.9 404.5C315.2 410.9 310.4 416.8 310.2 417.6C309.6 420.1 314.8 421.1 325.9 420.5C331.7 420.2 338 419.7 339.8 419.4C343.1 418.9 343.2 418.8 342.5 415.2C341.8 410.8 336.1 398.5 333.3 395.1L331.4 392.7L320.9 404.5Z" />\n      <path style="fill: ${n}" d="M226 399.1C222.9 403.5 219.2 412.4 218.3 417.7L217.7 421L233.2 421C249.7 421 253.3 420.1 251.3 416.6C250 414.2 230.9 395 229.9 395C229.4 395 227.7 396.8 226 399.1Z" />\n      <path style="fill: ${n}" d="M278.6 404.6C275 408.1 278.6 413.3 283 411C285.6 409.6 285.6 405.4 283.1 404C280.6 402.7 280.4 402.7 278.6 404.6Z" />\n      <path style="fill: ${n}" d="M275.1 421.4C269.4 424.6 268.3 432.5 272.9 437.1C277.2 441.3 283 441.4 287.2 437.2C291.4 433 291.3 427.2 287.1 422.9C283.8 419.7 279.3 419.1 275.1 421.4Z" />\n      <path style="fill: ${n}" d="M256 426.4C254.1 428.7 255.2 432.5 257.8 432.8C262.2 433.5 264.5 429.6 261.4 426.6C259.5 424.6 257.6 424.6 256 426.4Z" />\n      <path style="fill: ${n}" d="M300.2 427.6C297.5 429.5 297.4 431.2 299.9 433.4C302.4 435.7 306 434 306 430.5C306 427.2 303 425.6 300.2 427.6Z" />\n      <path style="fill: ${n}" d="M224.5 440.7C216.8 441.3 216.9 441.2 218.6 447.2C220.2 452.7 224.7 461.8 227.8 465.8L229.6 468.1L239.9 455.9C245.6 449.2 250.3 443 250.4 442.1C250.5 440.7 249 440.5 240 440.4C234.2 440.4 227.3 440.5 224.5 440.7Z" />\n      <path style="fill: ${n}" d="M316.5 441.9C312.1 442.3 310.4 442.9 310.2 444.1C309.9 445.7 331.2 467 333 467C335.2 467 341.6 452.9 343.5 444.2L344.2 441L333.3 441.2C327.4 441.3 319.8 441.6 316.5 441.9Z" />\n      <path style="fill: ${n}" d="M277.6 448.6C275.7 450.4 275.7 450.6 277 453.1C277.6 454.2 279.1 455 280.5 455C282.5 455 285 452.6 285 450.6C285 449.6 281.8 447 280.5 447C279.8 447 278.4 447.7 277.6 448.6Z" />\n      <path style="fill: ${n}" d="M258.9 465.7C250.3 474.7 245 480.8 245 481.9C245 484.4 262.9 492 268.6 492L271.3 492L270.6 477.7C269.7 461.1 269.3 459 267.1 459C266.2 459 262.5 462 258.9 465.7Z" />\n      <path style="fill: ${n}" d="M293.6 459.9C293 460.9 291.2 476.7 290.7 485.7C290.4 491.7 290.5 492 292.6 492C300.5 492 318.8 485.2 317.4 482.8C316.9 482.1 312.1 476.4 306.6 470.2C297.3 459.7 294.9 457.8 293.6 459.9Z" />\n      <path fill-rule="evenodd" style="fill: ${t}" d="M1177.4 372.3C1211.7 424 1193.4 494.1 1138.2 522.3C1112.5 535.4 1085.4 537.5 1058 528.4C1045.7 524.3 1038.1 520.2 1026.9 511.8C988.2 482.6 975.7 427.1 998 383C1012.6 354.1 1040.5 333.3 1072.3 327.5C1112.3 320.2 1154.9 338.4 1177.4 372.3ZM1068.9 359.5C1036.5 370 1015.3 400.5 1017.3 434C1018.9 460.8 1034.6 484.4 1058.5 496C1104.4 518.2 1157.3 489.4 1164 438.6C1168.7 403.3 1145.6 368.8 1110.8 359C1097.8 355.3 1081.1 355.5 1068.9 359.5Z" />\n      <path style="fill: ${n}" d="M1101.7 383.2C1102 392.2 1102.6 399.9 1103.1 400.4C1104.4 401.8 1108.4 398.6 1118.6 388.2L1128.1 378.5L1125.8 376.7C1120.8 372.7 1106.9 367 1102.3 367C1101.3 367 1101.2 370.3 1101.7 383.2Z" />\n      <path style="fill: ${n}" d="M1070.5 369.4C1065.5 371 1057.2 375.2 1054.2 377.6L1051.9 379.5L1064 390.2C1070.7 396.2 1076.8 401 1077.5 401C1079.8 401 1080.2 397.1 1079.5 382.4C1078.7 366.2 1079.1 366.7 1070.5 369.4Z" />\n      <path style="fill: ${n}" d="M1130.7 404.6C1124.8 411.1 1120 417.2 1120 418.2C1120 419.3 1121.1 420 1123.8 420.4C1128.2 421.1 1151.6 419.7 1152.7 418.7C1154.2 417.1 1147.6 400.4 1143.3 395.1L1141.4 392.7L1130.7 404.6Z" />\n      <path style="fill: ${n}" d="M1036.2 398.7C1032.3 404.9 1029.2 412.1 1028.4 417.1L1027.7 421L1042.9 421C1051.5 421 1059 420.5 1060.1 420C1061.8 419 1061.9 418.7 1060.6 416.2C1059.8 414.7 1054.7 409.1 1049.2 403.7L1039.3 393.8L1036.2 398.7Z" />\n      <path style="fill: ${n}" d="M1088.8 404.1C1086.4 405.5 1086.5 409.7 1089 411C1093.4 413.3 1097 408.1 1093.4 404.6C1091.6 402.7 1091.1 402.7 1088.8 404.1Z" />\n      <path style="fill: ${n}" d="M1085.1 421.3C1080.2 424.2 1078.5 431.4 1081.6 435.9C1082.5 437.2 1084.8 438.8 1086.6 439.6C1089.5 440.8 1090.5 440.8 1093.4 439.6C1103.3 435.5 1101.9 421.6 1091.5 420.4C1089.1 420.1 1086.5 420.5 1085.1 421.3Z" />\n      <path style="fill: ${n}" d="M1066 426.4C1064.1 428.7 1065.2 432.5 1067.8 432.8C1072.2 433.5 1074.5 429.6 1071.4 426.6C1069.5 424.6 1067.6 424.6 1066 426.4Z" />\n      <path style="fill: ${n}" d="M1109.6 427.6C1108.7 428.4 1108 429.8 1108 430.5C1108 431.8 1110.6 435 1111.6 435C1113.6 435 1116 432.5 1116 430.5C1116 429.1 1115.2 427.6 1114.1 427C1111.6 425.7 1111.4 425.7 1109.6 427.6Z" />\n      <path style="fill: ${n}" d="M1033.5 440.9C1027.5 441.5 1027.5 441.5 1027.8 444.5C1028.7 451.4 1038.2 469.3 1040 467.4C1045.7 461.3 1061 442.4 1060.7 441.6C1060.3 440.4 1043.1 439.9 1033.5 440.9Z" />\n      <path style="fill: ${n}" d="M1126.7 441.7C1119.9 442.2 1118.8 443.6 1122 447.7C1124.3 450.8 1142 467 1143 467C1143.3 467 1145 464.6 1146.7 461.7C1149.6 456.9 1151.9 450.6 1153.4 443.7L1154 441L1143.3 441.2C1137.3 441.3 1129.9 441.5 1126.7 441.7Z" />\n      <path style="fill: ${n}" d="M1087 449C1085.4 452.1 1087.4 455.2 1090.8 454.8C1092.9 454.6 1093.6 453.9 1093.8 451.6C1094.3 447.1 1089.1 445.1 1087 449Z" />\n      <path style="fill: ${n}" d="M1065.1 469.7C1059.5 475.6 1055 481 1055 481.7C1055 484.5 1072.2 492 1078.7 492L1081.3 492L1080.6 479.7C1079.6 461.8 1079.1 459 1077 459C1076 459 1070.7 463.8 1065.1 469.7Z" />\n      <path style="fill: ${n}" d="M1103.5 459.9C1102.8 461.1 1101.2 474.3 1100.6 484.2C1100.2 491.9 1100.2 492 1102.5 492C1107 492 1115.5 489.8 1121.8 486.9L1128.2 484L1126.3 481.7C1119.8 473.5 1106.5 459 1105.4 459C1104.7 459 1103.9 459.4 1103.5 459.9Z" />\n  </svg>`},b={root:"WinnersTable-module__root--K3GdF",item:"WinnersTable-module__item--z3nFm","item--wins":"WinnersTable-module__item--wins--jggjW","item--time":"WinnersTable-module__item--time--MD0qf",winner:"WinnersTable-module__winner--RtsjJ"},L=async()=>{const{winners:t,winnersSort:n,winnersOrder:a,winnersPage:r,viewSettings:i}=z,[s,l]=await(async(e,t,n=1,a=10)=>{try{const r=await fetch(`${c}?_limit=${a}&_page=${n}&_sort=${e}&_order=${t}`);return 200===r.status?[{winners:await r.json(),count:Number(r.headers.get("X-Total-Count"))||0},null]:[null,u("Get Winners")]}catch(e){return[null,e]}})(n,a,r);l?console.error(l):(i.winnersTitle.innerText=`Winners (${s.count})`,i.winnersPage.innerText=`Page #${r}`,t.table.body.innerHTML="",s.winners.map(((n,a)=>(async(t,n,a)=>{const{id:r,wins:i,time:s}=t,[l,o]=await m(r),d=e("tr",b.winner,a);if(o)console.error(o);else{const{name:t,color:a}=l;e("td",null,d,`${n}`);const r=e("td",null,d);e("td",null,d,t),e("td",null,d,`${i}`),e("td",null,d,`${s}`),r.innerHTML=S(a)}return d})(n,a+1,t.table.body))),s.count/(10*r)<1?i.winnersNext.disabled=!0:i.winnersNext.disabled=!1)};var $,M;!function(e){e.ID="id",e.WINS="wins",e.TIME="time"}($||($={})),function(e){e.ASC="ASC",e.DESC="DESC"}(M||(M={}));const P=()=>{z.winnersOrder===M.ASC?z.winnersOrder=M.DESC:z.winnersOrder=M.ASC},_=()=>{z.winnersSort!==$.WINS?(z.winnersSort=$.WINS,z.winnersOrder=M.DESC):P(),z.winners?.table.update()},E=()=>{z.winnersSort!==$.TIME?(z.winnersSort=$.TIME,z.winnersOrder=M.ASC):P(),z.winners?.table.update()},T=()=>{if(z.winnersPage=z.winnersPage-1,1===z.winnersPage){const{winners:e,viewSettings:t}=z;t.winnersPrev.disabled=!0,e.table.update()}},x=()=>{const{winners:e,viewSettings:t}=z;z.winnersPage=z.winnersPage+1,t.winnersPrev.disabled=!1,e.table.update()},B=t=>{const n=e("div","Winners-module__root--ttgTj",t),a=(t=>{const n=e("table",b.root,t),a=e("thead",b.head,n),r=e("tbody",b.body,n);return e("th",b.item,a,"Position"),e("th",b.item,a,"Car"),e("th",b.item,a,"Name"),{container:n,head:a,body:r,wins:e("th",[b.item,b["item--wins"]],a,"Wins"),time:e("th",[b.item,b["item--time"]],a,"Time"),update:L}})(n);return{container:n,table:a,hide:()=>{n.style.display="none"},show:()=>{n.style.display="flex"}}},I=["Aston Martin","Audi","Bentley","BMW","Bugatti","Cadillac","Chevrolet","Chrysler","CitroÃ«n","Dodge","Ferrari","Fiat","Ford","Honda","Hummer","Hyundai","Infiniti","Jaguar","Jeep","Kia","Lada","Lamborghini","Land Rover","Lexus","Lotus","Maserati","Maybach","Mazda","McLaren","Mercedes-Benz","Mitsubishi","Nissan","Opel","Peugeot","Porsche","Renault","Rolls-Royce","Skoda","Subaru","Suzuki","Tesla","Toyota","Volkswagen","Volvo"],Z=["Corolla","Camry","RAV4","CR-V","Sentra","Civic","HR-V","Accord","Speedtail","Veyron","Agera R","Chiron","Venom GT","3 Series","X1","Z4","X7","5 Series","7 Series","X3","M340i","M4 Competition"],N=async(e,t)=>{if(z.garage.slots){const n=z.garage.slots.filter((t=>t.id===e))[0],{startBtn:a,stopBtn:r,carImage:i}=n;n.animation=((e,t)=>{const n=getComputedStyle(t),a=getComputedStyle(t.parentElement),r=parseInt(n.width),i=parseInt(a.width),s=t.animate([{transform:"translateX(0px)"},{transform:`translateX(calc(${i}px - ${r}px))`}],{duration:e,easing:"ease-in-out"});return s.play(),s.onfinish=()=>{t.style.transform="translateX(0px))"},s})(t,i);const[s,l]=await(async e=>{try{const t=await fetch(`${g}?id=${e}&status=drive`,{method:"PATCH"});if(200===t.status)return[await t.json(),null];const n="Set Car Engine to Drive";return 400===t.status?[null,p(n)]:404===t.status?[null,C(n)]:429===t.status?[null,w(n)]:500===t.status?[null,y(n)]:[null,u(n)]}catch(e){return[null,e]}})(e);return r.disabled=!0,a.disabled=!1,l?(n.animation.pause(),console.error(l),l):s}return new Error("")},k=async e=>{if(z.garage.slots){const{startBtn:t,stopBtn:n,animation:a}=z.garage.slots.filter((t=>t.id===e))[0];a&&a.cancel();const[r,i]=await f(e,"started");if(i)return console.error(i),new Promise(((t,n)=>n([e,null])));{t.disabled=!0,n.disabled=!1;const a=Math.round(r.distance/r.velocity);return await N(e,a)instanceof Error?new Promise(((t,n)=>n([e,null]))):new Promise((t=>t([e,a])))}}return new Promise(((t,n)=>n([e,null])))},D=async e=>{if(z.garage.slots){const{startBtn:t,stopBtn:n,animation:a}=z.garage.slots.filter((t=>t.id===e))[0],[,r]=await f(e,"stopped");r?console.error(r):(a?.cancel(),n.disabled=!0,t.disabled=!1)}},G=e=>{const{selectBtn:t,removeBtn:n,startBtn:a,stopBtn:r,id:i}=e;t.addEventListener("click",(e=>(async(e,t)=>{e.preventDefault();const{garageSettings:n}=z,{container:a,textInput:r,colorInput:i,enable:s}=n.updateForm,[l,o]=await m(t);o?console.error(o):(s(),r.value=l.name,i.value=l.color,a.dataset.carId=`${t}`)})(e,i))),n.addEventListener("click",(e=>(async(e,t)=>{e.preventDefault();const n=await(async e=>{try{const t=await fetch(`${d}/${e}`,{method:"DELETE"}),n="Delete Car";if(200===t.status)return;return 404===t.status?C(n):u(n)}catch(e){return e}})(t);n?console.error(n):(await(async e=>{try{const t=await fetch(`${c}/${e}`,{method:"DELETE"}),n="Delete Winner";if(200===t.status)return;return 404===t.status?C(n):u(n)}catch(e){return e}})(t),z.garage.update&&z.garage?.update(),await(z.winners?.table.update()))})(e,i))),a.addEventListener("click",(()=>k(i))),r.addEventListener("click",(()=>D(i)))},W=async()=>{const{garage:n,viewSettings:a,garagePage:r}=z,[i,s]=await(async(e=1,t=7)=>{try{const n=await fetch(`${d}?_limit=${t}&_page=${e}`);return 200===n.status?[{cars:await n.json(),count:Number(n.headers.get("X-Total-Count"))||0},null]:[null,u("Get Cars")]}catch(e){return[null,e]}})(r);s?console.error(s.message):(a.garageTitle.innerText=`Garage (${i.count})`,a.garagePage.innerText=`Page #${r}`,n.main.innerHTML="",n.slots=i.cars.map((a=>((n,a)=>{const{id:r,name:i}=n,s=e("div","GarageSlot-module__root--70Yvs",a.main),l=e("div","GarageSlot-module__main--JkID_",s),o=e("span","GarageSlot-module__name--BKmtw",l,`${i}`),d=e("div","GarageSlot-module__car--nXxOC",l),g=e("div","GarageSlot-module__footer--UGb0f",s),c=t({label:"Select",type:"button"},g),u=t({label:"Remove",type:"reset"},g),C=t({label:"Start",type:"button"},g),p=t({label:"Stop",type:"reset"},g);return d.innerHTML+=S(n.color),{container:s,carName:o,carImage:d,selectBtn:c,removeBtn:u,startBtn:C,stopBtn:p,id:r,start:void 0,stop:void 0,animation:void 0}})(a,n))),n.slots.forEach((e=>{G(e),e.stopBtn.disabled=!0,e.start=()=>k(e.id),e.stop=()=>D(e.id)})),i.count/(7*r)<1?a.garageNext.disabled=!0:a.garageNext.disabled=!1)},A=()=>{z.garagePage=z.garagePage-1;const{garage:e,viewSettings:t}=z;e.update&&(1===z.garagePage&&(t.garagePrev.disabled=!0),e.update())},O=()=>{z.garagePage=z.garagePage+1;const{garage:e,viewSettings:t}=z;e.update&&(t.garagePrev.disabled=!1,e.update())},R=()=>{const{createForm:e,updateForm:t,generateCarsBtn:n}=z.garageSettings,{garage:a,viewSettings:r}=z;e.container.addEventListener("submit",(e=>(async e=>{e.preventDefault();const{container:t,textInput:n,colorInput:a}=z.garageSettings.createForm;if(n.value){const e=await h({name:n.value,color:a.value});e?console.error(e):(z.garage.update&&z.garage.update(),t.reset())}})(e))),t.container.addEventListener("submit",(e=>(async e=>{e.preventDefault();const{container:t,textInput:n,colorInput:a,disable:r}=z.garageSettings.updateForm,i=t.dataset.carId;i&&n.value&&(await(async(e,t)=>{try{const n=await fetch(`${o}/garage/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a="Update Car";if(200===n.status)return;return 404===n.status?C(a):u(a)}catch(e){return e}})(+i,{name:n.value,color:a.value}),z.garage.update&&z.garage.update(),await(z.winners?.table.update()),r())})(e))),n.addEventListener("click",(()=>(async e=>{const t=((e=100)=>Array(e).fill(null).map((()=>({name:`${I[Math.floor(Math.random()*I.length)]} ${Z[Math.floor(Math.random()*Z.length)]}`,color:`#${Math.floor(16777215*Math.random()).toString(16)}`}))))().map((e=>h(e)));await Promise.all(t),e.update&&e.update()})(a))),r.garagePrev.addEventListener("click",A),r.garageNext.addEventListener("click",O)},F=t=>{const n=e("div","Garage-module__root--tKiif",t),a=e("div","Garage-module__main--pSHkD",n);return{container:n,main:a,hide:()=>{n.style.display="none"},show:()=>{n.style.display="flex"},slots:void 0,update:void 0}},j=(n,a,r)=>{const i=e("form","GarageSettings-module__form--kozWn",n),s=e("input","GarageSettings-module__text-input--P1IBE",i),l=e("input","GarageSettings-module__color-input--PY0h6",i),o=t({label:r,type:"submit"},i);return i.id=a,s.type="text",l.type="color",l.defaultValue="#000000",{container:i,textInput:s,colorInput:l,submitBtn:o,disable:()=>{i.reset(),s.disabled=!0,l.disabled=!0,o.disabled=!0},enable:()=>{i.reset(),s.disabled=!1,l.disabled=!1,o.disabled=!1}}},H=async()=>{const{slots:e}=z.garage;if(e){const t=e.map((e=>{if(e.start)return e.start()})),n=await Promise.any(t);if(n){const[e,t]=n;if(t){const[n,a]=await m(e);if(a)console.error(a);else{const a=+(t/1e3).toFixed(2),{garageSettings:r}=z;await(async(e,t)=>{const[n,a]=await(async e=>{try{const t=await fetch(`${c}/${e}`);if(200===t.status)return[await t.json(),null];const n="Get Winner";return 404===t.status?[null,C(n)]:[null,u(n)]}catch(e){return[null,e]}})(e);a?await(async e=>{try{const t=await fetch(`${c}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n="Create Winner";if(201===t.status)return;return 500===t.status?y(n):u(n)}catch(e){return e}})({id:e,wins:1,time:t}):await(async e=>{const{id:t,wins:n,time:a}=e;try{const e=await fetch(`${c}/${t}`,{method:"PATCH",headers:{"Content-type":"application/json"},body:JSON.stringify({wins:n,time:a})}),r="Update Winner";if(200===e.status)return;return 404===e.status?C(r):u(r)}catch(e){return e}})({id:e,wins:n.wins+1,time:n.time<t?n.time:t}),z.winners?.table.update()})(e,a),r.winnerMessage.innerText=`Winner: ${n.name}, time: ${a}s.`,r.winnerMessage.style.display="block",setTimeout((()=>{r.winnerMessage.style.display="none"}),5e3)}}}}},V=async()=>{const{garage:e}=z;if(e){const{slots:t}=e;if(t){const e=t.map((e=>{if(e.stop)return e.stop()}));await Promise.all(e)}}},U=n=>{const a=e("div","GarageSettings-module__root--WZiCU",n),r=e("div","GarageSettings-module__logo--OK1Ll",a,"ASYNC-RACE"),i=j(a,"create-form","Create"),s=j(a,"update-form","Update"),l=e("div","GarageSettings-module__footer--Wz4Vz",a),o=t({label:"Race"},l),d=t({label:"Reset"},l),g=t({label:"Generate Cars"},l),c=e("span","GarageSettings-module__message--DF0pv",a,"Winner: ");return r.href="/",{container:a,createForm:i,updateForm:s,raceBtn:o,resetBtn:d,generateCarsBtn:g,winnerMessage:c}},X=sessionStorage.getItem("view"),J=()=>{(()=>{const{viewSettings:e}=z,{garageBtn:t,winnersBtn:n}=e;t.addEventListener("click",i),n.addEventListener("click",s)})(),"garage"===z.view?a():r(),z.viewSettings,(()=>{const{garage:e,viewSettings:t}=z;R(),e.update=W,e.update(),"garage"!==z.view&&e.hide(),1===z.garagePage&&(t.garagePrev.disabled=!0)})(),(()=>{const{garageSettings:e}=z;(()=>{const{raceBtn:e,resetBtn:t}=z.garageSettings;e.addEventListener("click",H),t.addEventListener("click",V)})(),e.updateForm.disable(),e.winnerMessage.style.display="none"})(),(()=>{(()=>{const{winners:e,viewSettings:t}=z;e.table.wins.addEventListener("click",_),e.table.time.addEventListener("click",E),t.winnersPrev.addEventListener("click",T),t.winnersNext.addEventListener("click",x)})();const{winners:e,viewSettings:t}=z;e.table.update(),"winners"!==z.view&&e.hide(),1===z.winnersPage&&(t.winnersPrev.disabled=!0),z.winners})()};let z;const q=async()=>{const t=e("div",null,"body"),n=e("header",null,t),a=e("main",null,t);return t.id="app",r=a,i=n,s=a,z={viewSettings:l(n),garage:F(r),garageSettings:U(i),winners:B(s),view:X||"garage",garagePage:1,winnersPage:1,winnersSort:$.ID,winnersOrder:M.ASC},J(),{container:t,header:n,main:a};var r,i,s};window.addEventListener("DOMContentLoaded",(()=>q()))})();